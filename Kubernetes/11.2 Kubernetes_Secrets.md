# 11.2 : Secret ‚Äì Manage Sensitive Data Securely

https://drive.google.com/file/d/11eaDLUJR1O-Ykc29_XRjWMpFgs5T4Ic5/view?usp=sharing

### üéØ What It Is

A **Secret** is a Kubernetes resource that stores **sensitive data** like passwords, API keys, tokens, or certificates ‚Äî **separate from your application code and container image**.

> üîí Important: Secrets are base64-encoded (not encrypted). For true encryption, enable etcd encryption at rest.
> 

### üí° Real-World Analogy

> Think of a Secret like a password manager ‚Äî it keeps your credentials safe, separate, and injects them only when needed ‚Äî never baked into your app.
> 

---

### üß™ Example: Inject Database Password as Environment Variable

**Step 1: Create a Secret (using `stringData` for readability)**

```yaml
# db-secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: mysql-creds
  namespace: dev
type: Opaque

  username: "admin"
  password: "s3cr3tP@ss123"

```

> ‚úÖ Note: stringData lets you write plain text ‚Äî Kubernetes auto-encodes it to base64.
> 

Apply it:

```bash
kubectl apply -f db-secret.yaml

```

**Step 2: Use It in a Pod**

```yaml
# mysql-pod.yaml
apiVersion: v1
kind: Pod
metadata:
  name: mysql-app
  namespace: dev
spec:
  containers:
  - name: app
    image: nginx
    env:
    - name: DB_USER
      valueFrom:
        secretKeyRef:
          name: mysql-creds
          key: username
    - name: DB_PASS
      valueFrom:
        secretKeyRef:
          name: mysql-creds
          key: password

```

Apply and test:

```bash
kubectl apply -f mysql-pod.yaml
kubectl exec mysql-app -n dev -- printenv | grep DB_PASS
# Output: DB_PASS=s3cr3r3tP@ss123

```

‚úÖ **Result**: Your app gets secrets **without hardcoding them**!

---

### ‚úÖ Summary YAML

```yaml
# Create Secret (use stringData!)
apiVersion: v1
kind: Secret
meta
  name: my-secret
type: Opaque
stringData:
  key1: "sensitive-value"

# Use in Pod
env:
- name: SECRET_VAR
  valueFrom:
    secretKeyRef:
      name: my-secret
      key: key1

```

---

### ‚ùì Common Questions

**Q: Is base64 encryption?**

‚ùå **No!** Base64 is **encoding**, not encryption. Anyone with `kubectl get secrets` can decode it.

**Q: How do I decode a Secret manually?**

```bash
kubectl get secret mysql-creds -n dev -o jsonpath='{.data.password}' | base64 -d
# Output: s3cr3tP@ss123

```

**Q: Can I mount a Secret as a file?**

‚úÖ Yes! (See Topic 3) ‚Äî great for config files like `cert.pem`.

**Q: What‚Äôs the size limit for a Secret?**

‚û°Ô∏è **1 MiB** (same as ConfigMap).

---

### üõ†Ô∏è Best Practices

1. ‚úÖ **Never commit Secrets to Git** ‚Äî use `.gitignore` or external secret managers (Vault, AWS Secrets Manager).
2. ‚úÖ **Always use `stringData`** ‚Äî it‚Äôs human-readable and less error-prone.
3. ‚úÖ **Restrict access with RBAC**:
    
    ```yaml
    # Only allow devs to get secrets in dev namespace
    rules:
    - apiGroups: [""]
      resources: ["secrets"]
      verbs: ["get", "list"]
    
    ```
    
4. ‚úÖ **Enable etcd encryption at rest** for production clusters.
5. ‚úÖ For production, use **External Secrets Operator (ESO)** to sync from Vault/AWS/GCP.