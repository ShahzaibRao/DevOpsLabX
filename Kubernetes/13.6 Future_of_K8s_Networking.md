# **13.6 : Gateway API â€“ The Future of Kubernetes Networking**

### ğŸ¯ What It Is

**Gateway API** is a **next-generation** Kubernetes networking standard that **replaces Ingress** with more **expressive, role-oriented, and extensible** resources.

> âœ… Why?
> 
> - Ingress is **limited to HTTP/S** and **lacks standardization** across controllers
> - Gateway API supports **HTTP, TCP, UDP, TLS**, and **custom protocols**
> - Designed for **multi-team workflows** (platform engineers vs app developers)

### ğŸ’¡ Real-World Analogy

> Like upgrading from a basic doorbell (Ingress) to a smart building access system (Gateway API):
> 
> - **Security team** (platform) controls the **main gate** (`Gateway`)
> - **Department managers** (developers) request **access rules** (`HTTPRoute`)
> - **Visitors** get routed securely without touching the gate hardware

---

### ğŸ§ª Example: Replace Ingress with Gateway API (HTTP Routing)

**Step 1: Install Gateway API CRDs (One-Time)**

```bash
kubectl get crd gateways.gateway.networking.k8s.io &>/dev/null || \\
  kubectl apply -f <https://github.com/kubernetes-sigs/gateway-api/releases/download/v1.1.0/standard-install.yaml>

```

**Step 2: Deploy a GatewayClass (Platform Team)**

```yaml
# gatewayclass.yaml
apiVersion: gateway.networking.k8s.io/v1
kind: GatewayClass
meta
  name: traefik-gc
spec:
  controllerName: traefik.io/gateway-controller

```

> ğŸ”‘ Note: Traefik v2.10+ supports Gateway API. For k3s, ensure youâ€™re using a recent version.
> 

**Step 3: Create a Gateway (Platform Team)**

```yaml
# gateway.yaml
apiVersion: gateway.networking.k8s.io/v1
kind: Gateway
meta
  name: external-http
  namespace: default
spec:
  gatewayClassName: traefik-gc
  listeners:
  - name: http
    port: 80
    protocol: HTTP
    allowedRoutes:
      namespaces:
        from: All  # Or "Selector" for multi-tenant

```

**Step 4: Create an HTTPRoute (App Team)**

```yaml
# httproute.yaml
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
meta
  name: web-route
  namespace: default
spec:
  parentRefs:
  - name: external-http  # â† Reference Gateway
  hostnames:
  - "web.example.com"
  rules:
  - matches:
    - path:
        type: PathPrefix
        value: /
    backendRefs:
    - name: web
      port: 80

```

âœ… **Result**: Same as Ingress â€” but **cleaner separation of concerns** and **standardized**.

---

### âœ… Summary: Gateway API vs Ingress

| Feature | Ingress | Gateway API |
| --- | --- | --- |
| **Scope** | HTTP/S only | HTTP, TCP, UDP, TLS, custom |
| **Extensibility** | Annotations (controller-specific) | First-class CRDs |
| **Roles** | One resource (developer) | `GatewayClass` (platform) + `HTTPRoute` (developer) |
| **Standardization** | Minimal spec, vendor-specific features | Kubernetes SIG-NETWORK standard |
| **Multi-namespace** | Hard | Built-in (`allowedRoutes.namespaces`) |

---

### ğŸ§ª Advanced: TLS & Path Routing in Gateway API

```yaml
# httproute-tls.yaml
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
meta
  name: secure-app
spec:
  parentRefs:
  - name: external-https
  hostnames: ["myapp.com"]
  rules:
  - matches:
    - path:
        type: PathPrefix
        value: /api
    backendRefs:
    - name: api
      port: 80
  - matches:
    - path:
        type: PathPrefix
        value: /
    backendRefs:
    - name: frontend
      port: 80

```

With a TLS-enabled Gateway:

```yaml
# gateway-tls.yaml
apiVersion: gateway.networking.k8s.io/v1
kind: Gateway
spec:
  listeners:
  - name: https
    port: 443
    protocol: HTTPS
    tls:
      certificateRefs:
      - kind: Secret
        group: ""
        name: my-tls-secret

```

---

### â“ Common Questions

**Q: Does k3s support Gateway API?**

âœ… **Yes!** With **Traefik v2.10+** (k3s v1.27+ includes it).

â¡ï¸ Enable with: `k3s server --disable traefik` + install latest Traefik Helm chart.

**Q: Should I migrate from Ingress to Gateway API?**

â¡ï¸ **New projects**: âœ… Yes

â¡ï¸ **Existing projects**: Wait until your Ingress Controller has **stable Gateway API support**

**Q: Can I use both Ingress and Gateway API together?**

âœ… Yes! They operate independently.

**Q: What about cert-manager?**

âœ… Works with Gateway API via **`cert-manager.io/v1` Certificate** + `secretName` in Gateway.

---

### ğŸ› ï¸ Best Practices

1. âœ… **Use Gateway API for new greenfield projects**
2. âœ… **Adopt role-based workflow**:
    - Platform team: manages `GatewayClass` + `Gateway`
    - App team: creates `HTTPRoute`/`TCPRoute`
3. âœ… **Prefer standard CRDs over annotations**
4. âœ… **Test with `kubectl get gateway,httproute`**
5. âœ… **Monitor adoption** â€” Nginx, Traefik, Istio, Cilium all support it

---

## ğŸ Chapter 10 Complete! ğŸ‰

You now know how to:

- âœ… Expose apps with **Ingress**
- âœ… Use **Traefik in k3s** out-of-the-box
- âœ… Secure traffic with **TLS**
- âœ… Route by **host and path**
- âœ… Extend with **annotations**
- âœ… Adopt the future with **Gateway API**

---